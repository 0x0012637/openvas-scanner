#!/bin/sh

# OpenVAS
# $Id$
# Description: shellscript to remove an openvas user.
#
# Authors: - Renaud Deraison <deraison@nessus.org> (Original pre-fork develoment)
#          - Tim Brown <mailto:timb@openvas.org> (Initial fork)
#          - Laban Mwangi <mailto:labanm@openvas.org> (Renaming work)
#          - Tarik El-Yassem <mailto:tarik@openvas.org> (Headers section)
#
# Copyright:
# Portions Copyright (C) 2006 Software in the Public Interest, Inc.
# Based on work Copyright (C) 1998 - 2006 Tenable Network Security, Inc.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 2,
# as published by the Free Software Foundation
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
#
#
#


prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=@bindir@
sbindir=@sbindir@
libexecdir=@libexecdir@
datadir=@datadir@
sysconfdir=@sysconfdir@
sharedstatedir=@sharedstatedir@
localstatedir=@localstatedir@/lib
libdir=@libdir@
includedir=@includedir@
oldincludedir=@oldincludedir@
infodir=@infodir@
mandir=@mandir@
is_cygwin=@is_cygwin@

openvasd=@sbindir@/openvasd
openvasd_users=@sysconfdir@/openvas/openvasd.users

# check if gettext is present

if [ -f /usr/bin/gettext.sh ];
then

  # initialize gettext

  . gettext.sh
  export TEXTDOMAIN=nessus-scripts
  export TEXTDOMAINDIR=@datadir@/locale

else

  # define dummy functions

  gettext () {
    echo $1
  }

  eval_gettext () {
    echo $1
  }

fi

#
# check whether we have echo -n, depending
# on the current shell, used
case `echo -n` in
\-n)	Xn=   ; Xc='\c' ;;
*)	Xn=-n ; Xc=
esac

if [ -z "$is_cygwin" ];
then
 # make sure that we are root
 case `id` in uid=0*) ;; *)
    gettext "Only root should use openvas-rmuser."; echo
    exit 1
 esac
fi


login="$1"

test -z "$login" && {
echo $Xn "`gettext "Login to remove :"` $Xc"
read login
}

test -z "$login" && {
 gettext "No login entered"
 exit 1
}

if [ -d "$localstatedir/openvas/users/$login" ];
then
 rm -rf "$localstatedir/openvas/users/$login"
 gettext "user removed."; echo
else
 gettext "user does not exist"; echo
fi
